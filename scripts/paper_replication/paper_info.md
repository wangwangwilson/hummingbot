好的，这是一份为您详细拆解的、关于您上传的论文 `ssrn-5066176 (2).pdf`（《Market Making in Crypto》）的**策略、逻辑与参数**的详细说明。

本文档的目标是开发一种用于加密货币永续合约的**自动化做市 (Market Making) 算法**，该算法使用 **Hummingbot** 平台进行回测和实盘交易。

---

## 1. 核心策略：PMM BP (Pure Market Making + Bar Portion)

论文的最终策略被命名为 **PMM BP**。该策略是对 Hummingbot 平台中一个名为 **PMM Dynamic** 的现有策略的**重大改进**。

* **基线策略 (PMM Dynamic):** 这是一个动态做市策略，它根据 **MACD** 信号来调整其参考中间价 (mid-price)，并根据 **NATR** (波动率) 来调整价差 (spread)。
* **最终策略 (PMM BP):** 论文作者发现 MACD 信号**无效**（Sharpe 仅为 -0.01）。他们开发了一个新的 Alpha 信号，名为 **"Bar Portion (BP)"**，用它**取代 MACD** 来调整参考中间价。实盘结果证明 PMM BP 策略全面优于 PMM Dynamic 策略。

---

## 2. 核心 Alpha 信号："Bar Portion (BP)" 的详细逻辑

Bar Portion (BP) 是本文最核心的创新。它是一个基于 K 线数据计算的、用于**预测短期均值回归**的因子。

### 2.1 因子计算逻辑

该因子基于**1分钟** K 线数据计算：

* **公式:** `BP = (Close - Open) / (High - Low)`
* **值域:** `-1` 到 `+1`

### 2.2 因子解释

* `BP = +1`: 意味着这是一根**极强的大阳线**（开盘价=最低价，收盘价=最高价）。
* `BP = -1`: 意味着这是一根**极强的大阴线**（开盘价=最高价，收盘价=最低价）。
* `BP 约等于 0`: 意味着这是一个十字星或 K 线实体很短。

### 2.3 核心 Alpha 逻辑（均值回归）

作者通过五分位分析 (Quintile Analysis) 发现，BP 信号与未来收益呈**单调递减**关系，这揭示了强烈的**均值回归**效应：

* **当 BP 值很高时 (例如 > 0.7)**：表示市场刚刚经历了一次快速的（1分钟内）价格拉升。**策略逻辑：** 市场大概率会回调。**预测：未来收益为负。**
* **当 BP 值很低时 (例如 < -0.7)**：表示市场刚刚经历了一次快速的价格下跌。**策略逻辑：** 市场大概率会反弹。**预测：未来收益为正。**

在 PMM BP 策略中，这个信号被用来调整做市商的参考中间价，使其**偏离 (skew)** 市场中间价，从而更积极地捕捉这种均值回归。

---

## 3. 风险管理：三重障碍 (Triple Barrier) 与波动率优化

策略的风险管理框架基于“三重障碍”和对波动率的参数校准。

### 3.1 三重障碍策略 (Triple Barrier)

这是做市策略中用于平仓（管理持仓风险）的逻辑，包含三个核心参数：

1.  **Stop Loss (止损):** 允许的最大亏损阈值。
2.  **Take Profit (止盈):** 预设的盈利目标阈值。
3.  **Time Limit (时间限制):** 如果前两者都未触发，持仓达到一定时间后强制平仓。

### 3.2 参数与波动率的关系 (Optuna 优化)

作者使用 **Optuna** 优化框架，以**最大化夏普比率**为目标，在 30 种加密货币上优化参数，并得出了关键结论：

* **价差 (Spread) vs. 波动率:**
    * **发现:** `Start Spread` (起始价差) 和 `Step Spread` (多档订单间的步进价差) 与**月度波动率**呈**强正相关** (R² 极高)。
    * **策略逻辑:** 市场越不稳定（波动率高），做市商必须设置更宽的价差来保护自己。
    * **参数参考:** 优化的价差约等于**月度波动率的 4 到 5 倍**。

* **止盈/止损 (SL/TP) vs. 波动率:**
    * **发现:** `Stop Loss` 和 `Take Profit` 阈值与**月度波动率**之间**几乎没有相关性** (R² 接近 0)。
    * **策略逻辑:** 这意味着 SL/TP 参数不能简单地设为波动率的倍数，它们必须根据每个品种的历史表现和特定市场条件进行**独立优化**。

---

## 4. 详细参数列表 (基于 PMM Simple & Dynamic)

策略中使用的参数主要来自 Hummingbot 平台的 PMM 策略配置。

### 4.1 PMM Simple / Dynamic 基础参数

| 参数 (Parameter) | 详细说明 |
| :--- | :--- |
| **Connector** | 交易所名称 (例如: `okx`, `binance`)。 |
| **Trading Pair** | 交易对 (例如: `SOL-USDT`)。 |
| **Leverage** | 杠杆倍数。 |
| **Total Amount of Quote** | 用于策略的总报价金额 (例如: 500 USDT)。 |
| **Position Mode** | `HEDGE` (对冲模式，可同时持有多空) 或 `ONE-WAY` (单向模式)。 |
| **Number of Order Levels** | 做市订单的档位数 (例如: 设置 2 档买单和 2 档卖单)。 |
| **Spread for Levels** | (已通过 Optuna 优化) 每一档订单距离中间价的价差。 |
| **Amount for Levels** | 每一档订单的挂单金额。 |

### 4.2 风险与执行参数 (PMM Simple)

| 参数 (Parameter) | 详细说明 | 回测优化结果 (PEPE-USDT) |
| :--- | :--- | :--- |
| **Stop Loss Cooldown Time** | 止损触发后，等待多久才重新启动止损逻辑。 | 8 到 9 分钟 |
| **Executor Refresh Time** | 策略执行器的刷新频率（检查市场和调整订单）。 | 3 到 5 分钟 |
| **Stop Loss** | (三重障碍之一) 止损百分比。 | 独立优化 |
| **Take Profit** | (三重障碍之一) 止盈百分比。 | 独立优化 |
| **Time Limit** | (三重障碍之一) 持仓时间限制。 | （图8中重要性最高） |
| **Trailing Stop** | 移动止损参数。 | - |

### 4.3 PMM BP 特有参数 (PMM Dynamic 变体)

PMM BP 策略继承自 PMM Dynamic，因此包含以下用于动态调整的参数：

| 参数 (Parameter) | 详细说明 |
| :--- | :--- |
| **Alpha Signal (核心)** | **Bar Portion (BP)** (取代了原版的 MACD)。 |
| `NATR Length` | 用于计算归一化平均真实波幅 (NATR) 的周期长度。 |
| `MACD Fast` / `Slow` / `Signal` | (在 PMM BP 中被 BP 信号取代，但在 PMM Dynamic 中使用)。 |

---

## 5. 实盘交易对比 (PMM BP vs PMM Dynamic)

作者在 OKX 交易所对 SOL, DOGE, GALA 进行了 24 小时实盘对比，所有风险参数（SL/TP等）均保持一致。

| 交易对 | PMM BP (新策略) 净 P&L | PMM Dynamic (基线/MACD) 净 P&L | 结论 |
| :--- | :--- | :--- | :--- |
| **SOL-USDT** | **$1.21 (盈利)** | -$1.59 (亏损) | PMM BP 显著优胜 |
| **DOGE-USDT** | **$3.19 (盈利)** | $3.21 (盈利) | 表现持平 (但 BP 效率更高) |
| **GALA-USDT** | **-$6.56 (亏损)** | -$9.78 (亏损) | 市场剧烈波动，双方均亏损，但 PMM BP 亏损显著更少 |

**总结：** 论文详细论证了 **Bar Portion (BP)** 信号（(Close-Open)/(High-Low)）是一个有效的**均值回归**因子。将其整合到 PMM 策略中，用以**偏斜 (skew)** 参考中间价，在实盘中证明了其在盈利能力和风险控制（更少的亏损）上均优于传统的 MACD 信号。